import logging;reload(logging)
FORMAT="%(asctime)-8s%(message)s"
logging.basicConfig(format=FORMAT, filename="testlog.log", level=logging.DEBUG)

logging.info("=====Uploading first set of custom assets=====")

exists("NewProjectbtn-160421-VVD-0.1.png", 30)
click()
wait("NewProjectNameField-160421-VVD-0.1.png")
paste("SikuliX-Asset_Test")
click("EmptyProjectBtn-160421-VVD-0.1.png")
if not exists("MapWizardBtns-160421-VVD-0.1.png", 10):
    print"[error] Map selection panel not found!"
    logging.error("[error] Map selection panel not found!")
    exit(1)
click(Pattern("MapWizardBtns-160421-VVD-0.1.png").targetOffset(1,-10))
click(Pattern("MapWizardBtns-160421-VVD-0.1.png").targetOffset(-5,30))
if not exists("Editor-StakeholderBtn-160421-VVD-0.1.png", 15):
    print("[error] The project was not created as expected!")
    logging.error("[error] The project was not created as expected!")
    exit(1)
else:
    print("[success] An empty map has been created!")
    logging.info("[success] An empty map has been created!")

click("Editor-StakeholderBtn-160421-VVD-0.1.png")
click("Editor-Stakeholders-StakeholderBtn-160421-VVD-0.1.png")
click("Editor-Stakeholders-AddCivilianBtn-160421-VVD-0.1.png")
if not exists("Editor-Stakeholders-Civilian-LeftPanel-160421-VVD-0.1.png", 10):
    print"[error] Stakeholder creation failed!"
    logging.error("[error] Stakeholder creation failed!")
    exit(1)
else:
    print"[success] Stakeholder creation successful!"
    logging.info("[success] Stakeholder creation successful!")
click("Editor-Stakeholders-Civilian-LeftPanel-160421-VVD-0.1.png")
wait("Editor-Stakeholders-StakeholderIconBtn-160421-VVD-0.1.png", 10)
#click(Pattern("1459851922961.png").targetOffset(-25,-4))
click(Pattern("Editor-Stakeholders-StakeholderIcons-TopBar-160421-VVD-0.1.png").targetOffset(91,1))
wait("Editor-Stakeholders-StakeholderIcons-TopBar-160421-VVD-0.2.png", 10)

click("Editor-Stakeholders-StakeholderIconBtn-160421-VVD-0.1.png")
wait("Editor-Stakeholders-SelectStakeholderIconPanel-160421-VVD-0.1.png", 15)
click(Pattern("Editor-Stakeholders-SelectStakeholderIconPanel-160421-VVD-0.1.png").targetOffset(-173,205))
wait("Editor-ChooseCustomAssetPanel-Win7-160421-VVD-0.1.png", 10)
click(Pattern("Editor-ChooseCustomAssetPanel-Win7-160421-VVD-0.1.png").targetOffset(-16,-216))
if Settings.isWindows():
    paste("C:\Users\Vincent\Desktop\AssetTest-0331\Origineel")
elif Settings.isLinux():
    paste("home/tygron/Desktop/AssetTest-0331/Origineel")
else: 
    paste("Users/Tygron/Desktop/AssetTest-0331/Origineel")
type(Key.ENTER)
click("CustomAssetTest-Original-100x100-160421-VVD-0.1.png")
click("Editor-ChooseCustomAssetPanel-Win7-OpenBtn-160421-VVD-0.1.png")
wait("Editor-Stakeholders-SelectOriginalStakeholderIconl-160421-VVD-0.1.png", 10)
click(Pattern("Editor-Stakeholders-SelectOriginalStakeholderIconl-160421-VVD-0.1.png").targetOffset(33,-179))
click(Pattern("Editor-Stakeholders-SelectOriginalStakeholderIconl-160421-VVD-0.1.png").targetOffset(107,248))
click("Editor-Stakeholders-ActionMenu-CustomIcon-ClickHere-160421-VVD-0.1.png")
if not exists("Editor-Stakeholders-Stakeholder-CustomIcon-Check-160421-VVD-0.1.png", 15):
    print("[error] The custom stakeholder image was not added as expected!")
    logging.error("[error] The custom stakeholder image was not added as expected!")
    exit(1)
else:
    print("[success] The custom stakeholder image was successfully added!")
    logging.info("[success] The custom stakeholder image was successfully added!")
click("Editor-Stakeholders-ActionsBtn-160421-VVD-0.1.png")
exists("Editor-Stakeholders-Actions-AddBtn-LeftBar-160421-VVD-0.1.png")
click("Editor-Stakeholders-Actions-AddBtn-LeftBar-160421-VVD-0.1.png")
click("Editor-Stakeholders-NewActions-LeftPanel-160421-VVD-0.1.png")
wait("Editor-Stakeholders-ActionIconBtn-160421-VVD-0.1.png", 5)
click()
wait("Editor-Stakeholders-SelectActionMenuIconPanel-160421-VVD-0.1.png", 5)
click(Pattern("Editor-Stakeholders-SelectActionMenuIconPanel-160421-VVD-0.1.png").targetOffset(-175,204))
wait("Editor-ChooseCustomAssetPanel-Win7-160421-VVD-0.1.png", 10)
click("CustomAssetTest-Original-78x78-160421-VVD-0.1.png")
click("Editor-ChooseCustomAssetPanel-Win7-OpenBtn-160421-VVD-0.1.png")
click(Pattern("Editor-Stakeholders-SelectOriginalActionMenuIcon-160421-VVD-0.1.png").targetOffset(2,-183))
click("Editor-CustomAssets-ApplyBtn-160421-VVD-0.1.png")
if not exists("Editor-Stakeholders-ActionMenu-CustomIcon-Check-160421-VVD-0.1.png", 15):
    print("[error] The custom action menu image was not added as expected!")
    logging.error("[error] The custom action menu image was not added as expected!")
    exit(1)
else:
    print("[success] The custom action menu image was successfully added!")
    logging.info("[success] The custom action menu image was successfully added!")
click("Editor-Stakeholders-MeasuresBtn-160421-VVD-0.1.png")
click(Pattern("Editor-Stakeholders-Measures-AddBtn-LeftBar-160421-VVD-0.1.png").targetOffset(-73,29))
click("Editor-Stakeholders-NewMeasure-LeftPanel-160421-VVD-0.1.png")
click("Editor-Stakeholders-MeasureIconBtn-160421-VVD-0.1.png")
wait("Editor-Stakeholders-SelectMeasureIconPanel-160421-VVD-0.1.png", 5)
click(Pattern("Editor-Stakeholders-SelectMeasureIconPanel-160421-VVD-0.1.png").targetOffset(-175,205))
wait("Editor-ChooseCustomAssetPanel-Win7-160421-VVD-0.1.png", 10)
click("CustomAssetTest-Original-200x100-160421-VVD-0.1.png")
click("Editor-ChooseCustomAssetPanel-Win7-OpenBtn-160421-VVD-0.1.png")
click(Pattern("Editor-Stakeholders-SelectOriginalMeasureIcon-160421-VVD-0.1.png").targetOffset(13,-187))
click("Editor-CustomAssets-ApplyBtn-160421-VVD-0.1.png")
if not exists("Editor-Stakeholders-Measure-CustomIcon-Check-160421-VVD-0.1.png", 5):
    print("[error] The custom measure image was not added as expected!")
    logging.error("[error] The custom measure image was not added as expected!")
    exit(1)
else:
    print("[success] The custom measure image was successfully added!")
    logging.info("[success] The custom measure image was successfully added!")
click("Editor-Stakeholders-IndicatorBtn-160421-VVD-0.1.png")
click("Editor-Stakeholders-Indicators-FuncValBtn-160421-VVD-0.1.png")
wait("Editor-Stakeholders-Indicators-FuncValIcon-160421-VVD-0.1.png")
click()
wait(Pattern("Editor-Stakeholders-SelectOriginalMeasureIcon-160421-VVD-0.1.png").targetOffset(13,-187), 5)
click(Pattern("Editor-Stakeholders-SelectOriginalMeasureIcon-160421-VVD-0.1.png").targetOffset(13,-187))
click("Editor-CustomAssets-ApplyBtn-160421-VVD-0.1.png")
if not exists("Editor-Stakeholders-Indicators-FuncValIcon-Original-160421-VVD-0.1.png", 15):
    print("[error] The custom function value image was not added as expected!")
    logging.error("[error] The custom function value image was not added as expected!")
    exit(1)
else:
    print("[success] The custom function value image was successfully added!")
    logging.info("[success] The custom function value image was successfully added!")
click("Editor-Stakeholders-Indicators-FuncVal-PanelClose-160421-VVD-0.1.png")
click("Editor-StakeholderBtn-160421-VVD-0.1.png")
click("Editor-Stakeholders-ActionsBtn-160421-VVD-0.1.png")
click("Editor-Stakeholders-AssignedActions-LeftPanel-160421-VVD-0.1.png")
click("Editor-Stakeholders-Measure-RightPanel-160421-VVD-0.1.png")
click("Editor-Stakeholders-AssignMeasure-RightPanel-160421-VVD-0.1.png")
click("Editor-Stakeholders-MeasuresBtn-160421-VVD-0.1.png")
wait("Editor-Stakeholders-NewMeasure-LeftPanel-160421-VVD-0.1.png")
click("Editor-Stakeholders-NewMeasure-LeftPanel-160421-VVD-0.1.png")
click("Editor-Stakeholders-NewMeasure- AddBuilding-160421-VVD-0.1.png")
click("Editor-Stakeholders-NewMeasure- AddedBuilding-160421-VVD-0.1.png")
click("Editor-Stakeholders-Measure-AddedBuildingIconBtn-160421-VVD-0.1.png")
wait("Editor-Measures-ChooseFunctionPanel-160421-VVD-0.1.png", 10)
dragDrop(Pattern("Editor-Measures-ChooseFunctionPanel-160421-VVD-0.1.png").targetOffset(-94,-188), Pattern("Editor-Measures-ChooseFunctionPanel-160421-VVD-0.1.png").targetOffset(-93,118))
click("Editor-Measures-ChooseFunctionCategory-160421-VVD-0.1.png")
dragDrop(Pattern("Editor-Measures-ChooseFunctionPanel-RightSide-160421-VVD-0.1.png").targetOffset(201,-156), Pattern("Editor-Measures-ChooseFunctionPanel-RightSide-160421-VVD-0.1.png").targetOffset(199,-20))
if not exists("Editor-Stakeholders-Measures-FunctionImage-Original-160421-VVD-0.1.png"):
    print"[error] Can't find construction!"
    logging.error("[error] Can't find construction!")
    exit(1)
click()
click("Editor-CustomAssets-ApplyBtn-160421-VVD-0.1.png")
if not exists("Editor-Stakeholders-Measure-AddedBuildingIconBtn-Original-160421-VVD-0.1.png", 3):
    print"[error] Image not displayed as expected!"
    logging.error("[error] Image not displayed as expected!")
    
click("Editor-DrawAreaBtn-160421-VVD-0.1.png")
dragDrop(Pattern("Editor-DrawArea-160421-VVD-0.1.png").targetOffset(-111,-83), Pattern("Editor-DrawArea-160421-VVD-0.1.png").targetOffset(114,68))
click("Editor-DrawArea-ApplySelectionBtn-160421-VVD-0.1.png")
click("Editor-MainView-ActionMenuBtn-Original-160421-VVD-0.1.png")
wait("Editor-MainView-ActionMenuPanel-160421-VVD-0.1.png", 5)
click(Pattern("Editor-MainView-ActionMenuPanel-160421-VVD-0.1.png").targetOffset(54,181))
click("Editor-MainView-ActionMenuPanel-ConfirmBtn-160421-VVD-0.1.png")
click(Pattern("Editor-MainView-ActionMenuPanel-160421-VVD-0.1.png").targetOffset(89,-184))
click("Editor-MainView-MiniMapIcon-160421-VVD-0.1.png")
if not exists("Editor-MainView-MeasureConfirmationPanel-160421-VVD-0.1.png"):
    print"[error] Custom image for measure failed when executing measure!"
    logging.error("[error] Custom image for measure failed when executing measure!")
    exit(1)
click(Pattern("Editor-MainView-MeasureConfirmationPanel-160421-VVD-0.1.png").targetOffset(251,88))
click("Editor-TestRun-StopBtn-160421-VVD-0.1.png")
click("Editor-GeoDataBtn-160421-VVD-0.1.png")
click("Editor-GeoData-OverlaysBtn-160421-VVD-0.1.png")
wait("Editor-GeoData-OverlaysPanel-160421-VVD-0.1.png")
click("Editor-GeoData-OverlaysSelection-160421-VVD-0.1.png")
click("Editor-GeoData-SelectImageOverlay-160421-VVD-0.1.png")
click("Editor-Stakeholders-Actions-AddBtn-LeftBar-160421-VVD-0.1.png")
#########################################################
wait("1459775649066.png")
click(Pattern("1459775649066.png").targetOffset(-3,-34))
wait("1459776109999.png",10)
click("1459776109999.png")
wait("1459775709769.png")
click(Pattern("1459775709769.png").targetOffset(-179,206))
wait("1459769876588.png", 10)
click("1460455608235.png")
click("1460559214267.png")
click(Pattern("1459777670420.png").targetOffset(34,-138))
click(Pattern("1459777670420.png").targetOffset(98,260))
if not exists("1459777753539.png", 15):
    print("[error] The custom overlay image was not added as expected!")
    logging.error("[error] The custom overlay image was not added as expected!")
    exit(1)
else:
    print("[success] The custom overlay image was successfully added!")
    logging.info("[success] The custom overlay image was successfully added!")
click("1460472513836.png")

click("1459778258791.png")
click("1459778276391.png")
click("1459778311279.png")
wait("1459779320289.png", 5)
click(Pattern("1459779320289.png").targetOffset(-81,-87))
click(Pattern("1459779564558.png").targetOffset(-126,35))
wait("1459778396254.png", 5)
click("1459778406855.png")
click(Pattern("1459778424800.png").targetOffset(-2,4))
wait("1459769876588.png", 10)
#click(Pattern("1459769876588.png").targetOffset(-16,-216))
#dragDrop(Pattern("1459769876588.png").targetOffset(145,-215), Pattern("1459769876588.png").targetOffset(-321,-217))
#paste("C:\Users\Vincent\Desktop\AssetTest-0331\Origineel")
#type(Key.ENTER)
click("1459778481462.png")
click(Pattern("1459778534814.png").targetOffset(250,202))
if not exists("1459778582109.png", 15):
    print("[error] The excel indicator file was not added as expected!")
    logging.error("[error] The excel indicator file was not added as expected!")
    exit(1)
else:
    print("[success] The excel indicator file was successfully added!")
    logging.info("[success] The excel indicator file was successfully added!")
click("1460622747536.png")
if not exists("1459778707780.png", 15):
    print("[error] The excel indicator file output is not as expected!")
    logging.error("[error] The excel indicator file output is not as expected!")
    #exit(1)
else:
    print("[success] The excel indicator file shows the correct output!")
    logging.info("[success] The excel indicator file shows the correct output!")
click(Pattern("1460456062280.png").targetOffset(287,-224))

click("1460450493993.png")
sleep(1)
hover(Pattern("1460450548218.png").similar(0.91))
click(Pattern("1460459736270.png").similar(0.61))
wait("1460450592130.png", 5)
click(Pattern("1460450592130.png").targetOffset(-172,206))
click("1460450668056.png")
click("1460450698288.png")
if not exists("1460450769304.png", 15):
    print("[error] The custom indicator image was not uploaded as expected!")
    logging.error("[error] The custom indicator image was not uploaded as expected!")
    exit(1)
else:
    print("[success] The custom indicator image was successfully uploaded!")
    logging.info("[success] The custom indicator image was successfully uploaded!")
click("1460450769304.png")
click("1460450830055.png")
click("1460724919555.png")
if not exists(Pattern("1460450955231-1.png").similar(0.91), 15):
    print("[error] The custom indicator image was not added as expected!")
    logging.error("[error] The custom indicator image was not added as expected!")
    #exit(1)
else:
    print("[success] The custom indicator image was successfully added!")
    logging.info("[success] The custom indicator image was successfully added!")
if not exists(Pattern("1460451030070-1.png").similar(0.90), 15):
    print("[error] The custom indicator image did not appear on the top bar as expected!")
    logging.error("[error] The custom indicator image did not appear on the top bar as expected!")
    #exit(1)
else:
    print("[success] The custom indicator image appeared on the top bar as expected!")
    logging.info("[success] The custom indicator imappeared on the top bar as expected!")
click("1459780227625.png")
click("1459780248393.png")
wait(Pattern("1458740876103.png").targetOffset(-41,51), 5)
click(Pattern("1458740876103.png").targetOffset(-41,51))
if not exists("1459780227625.png", 5):
    print("[success] The project was saved and closed")
    logging.info("[success] The project was saved and closed")
else:
    print("[error] The project did not exit as expected!")
    logging.info("[error] The project did not exit as expected!")
    exit(1)

logging.info("=====Finished uploading first set of custom assets=====")

